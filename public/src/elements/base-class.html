<html><head><link rel="import" href="../../bower_components/polymer/polymer.html"><link rel="import" href="../../bower_components/polymer/polymer-element.html"><link rel="import" href="../../bower_components/iron-localstorage/iron-localstorage.html"><link rel="import" href="my-meta.html"><script type="text/javascript" src="../../languages.js"></script><script type="text/javascript" src="../../bower_components/moment/min/moment.min.js"></script><script type="text/javascript" src="../../bower_components/socket.io-client/dist/socket.io.slim.js"></script><link rel="import" href="../../bower_components/app-localize-behavior/app-localize-behavior.html"></head><body><dom-module id="base-class"><template><iron-localstorage name="user" value="{{userStorage}}"></iron-localstorage></template></dom-module><script>/**
  * @extends {Polymer.Element}
  * @appliesMixin Polymer.AppLocalizeBehavior
  */class BaseClass extends Polymer.mixinBehaviors([Polymer.AppLocalizeBehavior],Polymer.Element){static get is(){return"base-class"}static get properties(){return{userStorage:{type:Object},language:{value:function(){return localStorage.getItem("language")||defaultLang||"en"}}}}attached(){super.attached();this.loadResources(this.resolveUrl("../../../../../translations.json"))}refreshTable(ev){this.$.dataTableCard.retrieveVisibleData()}timestampFormatter(value){let date=moment(value).utc().format("LLL");return date}moneyFormatter(value){let res=app.localize("currency","amount",parseFloat(value).toFixed(currency.precision),"symbol",currency.symbol);return res}patchOverlay(e){if(e.target.withBackdrop){e.target.parentNode.insertBefore(e.target.backdropElement,e.target)}}getRows(context,table,filers,sort,page,pageSize,fullTextFields,fullTextValue){let rows=new Promise(/*#__PURE__*/function(){var _ref=babelHelpers.asyncToGenerator(function*(resolve,reject){socket.emit("getRows",table,filers,sort,(page-1)*pageSize,pageSize,fullTextFields,fullTextValue,function(status,result){if(200==status){resolve(result);return}if(context.$.dataTableCard)context.$.dataTableCard._datatable.set("progress",/* ignoreName */ /* ignoreName */!1/* skipSlots */ /* skipSlots */);if(666!=status)app.showErrorMessageForId(status);else app.showErrorMessage("An unknown error occured: \n"+JSON.stringify(result));reject(status)})});return function(_x,_x2){return _ref.apply(this,arguments)}}());rows.then(function(result){if(context&&context.data)context.set("data.length",0<result.length?result[0].count:0)});return rows}saveRow(table,row){return new Promise(/*#__PURE__*/function(){var _ref2=babelHelpers.asyncToGenerator(function*(resolve,reject){socket.emit("saveRow",table,row,function(status,result){if(200==status){resolve(result);return}if(666!=status)app.showErrorMessageForId(status);else app.showErrorMessage("An unknown error occured: \n"+JSON.stringify(result));reject(status)})});return function(_x3,_x4){return _ref2.apply(this,arguments)}}())}setColumnValue(table,id,column,value){return new Promise(/*#__PURE__*/function(){var _ref3=babelHelpers.asyncToGenerator(function*(resolve,reject){socket.emit("setColumnValue",table,id,column,value,function(status,result){if(200==status){resolve(result);return}if(666!=status)app.showErrorMessageForId(status);else app.showErrorMessage("An unknown error occured: \n"+JSON.stringify(result));reject(status)})});return function(_x5,_x6){return _ref3.apply(this,arguments)}}())}deleteRows(table,ids){return new Promise(/*#__PURE__*/function(){var _ref4=babelHelpers.asyncToGenerator(function*(resolve,reject){socket.emit("deleteRows",table,ids,function(status,result){if(200==status){resolve(result);return}if(666!=status)app.showErrorMessageForId(status);else app.showErrorMessage("An unknown error occured: \n"+result.toString());reject(status)})});return function(_x7,_x8){return _ref4.apply(this,arguments)}}())}unixToTimestamp(unix){var now=moment(1e3*unix);return now.format("YYYY-MM-DD HH:MM:SS")}deleteRowsCustom(table,filter){return new Promise(/*#__PURE__*/function(){var _ref5=babelHelpers.asyncToGenerator(function*(resolve,reject){socket.emit("deleteRowsCustom",table,filter,function(status,result){if(200==status){resolve(result);return}if(666!=status)app.showErrorMessageForId(status);else app.showErrorMessage("An unknown error occured: \n"+JSON.stringify(result));reject(status)})});return function(_x9,_x10){return _ref5.apply(this,arguments)}}())}markComplaintsReviewed(Ids){return new Promise(/*#__PURE__*/function(){var _ref6=babelHelpers.asyncToGenerator(function*(resolve,reject){socket.emit("markComplaintsReviewed",Ids,function(result){if(200===result)resolve();else reject()})});return function(_x11,_x12){return _ref6.apply(this,arguments)}}())}getImageAddressFromMedia(media){if(!media)return null;return this.getMediaPath(media)}getMediaPath(media){if("relative"===media.path_type){return document.createElement("iron-meta").byKey("server")+media.address}}setImageFromMedia(image,mediaId){if(!mediaId)return null;socket.emit("getRows","media",{id:mediaId},{property:"id",direction:"asc"},0,1,[],"",function(status,result){image.src=this.getMediaPath(result[0])}.bind(this))}refreshTable(ev){this.$.dataTableCard.retrieveVisibleData()}starConverter(valueInPercent){if(valueInPercent)return parseFloat(valueInPercent)/20;else return 0}haveAccess(table,permission){if(-1<JSON.parse(window.localStorage.user).user["permission_"+table].split(",").indexOf(permission))return!0/* skipSlots */;else return!1}}customElements.define(BaseClass.is,BaseClass);</script></body></html>