<html><head><link rel="import" href="../polymer/polymer.html"></head><body><dom-module id="iron-localstorage"></dom-module><script>Polymer({is:"iron-localstorage",properties:{/**
       * localStorage item key
       */name:{type:String,value:""},/**
       * The data associated with this storage.
       * If set to null item will be deleted.
       * @type {*}
       */value:{type:Object,notify:!0},/**
       * If true: do not convert value to JSON on save/load
       */useRaw:{type:Boolean,value:!1},/**
       * Value will not be saved automatically if true. You'll have to do it manually with `save()`
       */autoSaveDisabled:{type:Boolean,value:!1},/**
       * Last error encountered while saving/loading items
       */errorMessage:{type:String,notify:!0},/** True if value has been loaded */_loaded:{type:Boolean,value:!1}},observers:["_debounceReload(name,useRaw)","_trySaveValue(autoSaveDisabled)","_trySaveValue(value.*)"],ready:function(){this._boundHandleStorage=this._handleStorage.bind(this)},attached:function(){window.addEventListener("storage",this._boundHandleStorage)},detached:function(){window.removeEventListener("storage",this._boundHandleStorage)},_handleStorage:function(ev){if(ev.key==this.name){this._load(!0)}},_trySaveValue:function(){if(this.autoSaveDisabled===void 0||this._doNotSave){return}if(this._loaded&&!this.autoSaveDisabled){this.debounce("save",this.save)}},_debounceReload:function(){if(this.name!==void 0&&this.useRaw!==void 0){this.debounce("reload",this.reload)}},/**
     * Loads the value again. Use if you modify
     * localStorage using DOM calls, and want to
     * keep this element in sync.
     */reload:function(){this._loaded=!1;this._load()},/**
     * loads value from local storage
     * @param {boolean=} externalChange true if loading changes from a different window
     */_load:function(externalChange){try{var v=window.localStorage.getItem(this.name)}catch(ex){this.errorMessage=ex.message;this._error("Could not save to localStorage.  Try enabling cookies for this page.",ex)};if(null===v){this._loaded=!0;this._doNotSave=!0;// guard for save watchers
this.value=null;this._doNotSave=!1;this.fire("iron-localstorage-load-empty",{externalChange:externalChange},{composed:!0})}else{if(!this.useRaw){try{// parse value as JSON
v=JSON.parse(v)}catch(x){this.errorMessage="Could not parse local storage value";Polymer.Base._error("could not parse local storage value",v);v=null}}this._loaded=!0;this._doNotSave=!0;this.value=v;this._doNotSave=!1;this.fire("iron-localstorage-load",{externalChange:externalChange},{composed:!0})}},/**
     * Saves the value to localStorage. Call to save if autoSaveDisabled is set.
     * If `value` is null or undefined, deletes localStorage.
     */save:function(){var v=this.useRaw?this.value:JSON.stringify(this.value);try{if(null===this.value||this.value===void 0){window.localStorage.removeItem(this.name)}else{window.localStorage.setItem(this.name,/** @type {string} */v)}}catch(ex){// Happens in Safari incognito mode,
this.errorMessage=ex.message;Polymer.Base._error("Could not save to localStorage. Incognito mode may be blocking this action",ex)}}/**
     * Fired when value loads from localStorage.
     *
     * @event iron-localstorage-load
     * @param {{externalChange:boolean}} detail -
     *     externalChange: true if change occured in different window.
     */ /**
     * Fired when loaded value does not exist.
     * Event handler can be used to initialize default value.
     *
     * @event iron-localstorage-load-empty
     * @param {{externalChange:boolean}} detail -
     *     externalChange: true if change occured in different window.
     */});</script></body></html>